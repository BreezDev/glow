<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Glow Atelier | Bold injectables, private booking</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Archivo:wght@400;500;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/static/styles.css" />
  </head>
  <body>
    <div class="background-texture"></div>
    <nav class="top-nav">
      <div class="logo">Glow Atelier</div>
      <div class="nav-links">
        <a href="#profile">Client profile</a>
        <a href="#services">Treatments</a>
        <a href="#providers">Team</a>
        <a href="#booking" class="pill">Book now</a>
      </div>
    </nav>

    <header class="hero">
      <div class="hero__text">
        <p class="badge">Dearborn, Michigan · Nurse practitioner owned</p>
        <h1>
          A fearless injectable studio built so clients can sign up, pay deposits, and confirm visits without
          leaving.
        </h1>
        <p>
          Farah Bazzi, NP and Malak Sabbagh, NP reimagined Glow Atelier as a digital-first experience. Everything from
          your profile to concierge chat, booking, payment, and aftercare runs on this single page.
        </p>
        <div class="hero__cta">
          <a class="btn btn--primary" href="#profile">Create your client profile</a>
          <a class="btn btn--outline" href="#booking">Reserve appointment</a>
        </div>
        <ul class="hero__stats">
          <li><span>14</span> signature injectable blueprints</li>
          <li><span>4</span> minute deposit capture</li>
          <li><span>0</span> third-party redirects</li>
        </ul>
      </div>
      <div class="hero__panel">
        <div class="panel__orbit"></div>
        <div class="hero__panel-content">
          <p class="eyebrow">Immersive flow</p>
          <h3>Sign up → Choose ritual → Secure deposit</h3>
          <ol>
            <li>Complete the client profile for secure storage.</li>
            <li>Add rituals to your cart and pick the exact appointment date + time.</li>
            <li>Pay the ${{ deposit_amount }} per-ritual deposit via Square without leaving.</li>
            <li>Instant confirmation and prep slides into your inbox.</li>
          </ol>
          <p class="microcopy">Encrypted, nurse-led, and designed for decisive guests.</p>
        </div>
      </div>
    </header>

    <main>
      <section id="profile" class="section profile">
        <div>
          <p class="eyebrow">Start here</p>
          <h2>Build your Glow client profile</h2>
          <p>
            Tell us your goals, preferred communication channel, and the rituals you're eyeing. The profile locks in
            concierge messaging, intake paperwork, and same-page booking.
          </p>
          <ul class="checklist">
            <li>Secure contact + goals intake</li>
            <li>Fast-track to Square deposit</li>
            <li>Custom reminders + aftercare</li>
          </ul>
        </div>
        <form id="profile-form" class="card glass">
          <label for="profile-name">Full name</label>
          <input id="profile-name" name="profile-name" type="text" placeholder="Your name" required />
          <label for="profile-email">Email</label>
          <input id="profile-email" name="profile-email" type="email" placeholder="you@example.com" required />
          <label for="profile-phone">Phone</label>
          <input id="profile-phone" name="profile-phone" type="tel" placeholder="(313) 555-1234" required />
          <label for="profile-goal">Treatment focus</label>
          <textarea id="profile-goal" name="profile-goal" placeholder="Lip balance, tox refresh, PRP..." rows="3"></textarea>
          <button class="btn btn--primary" type="submit">Save profile</button>
          <p id="profile-success" class="microcopy" aria-live="polite"></p>
        </form>
      </section>

      <section id="services" class="section services">
        <div class="section__header">
          <p class="eyebrow">Ritual index</p>
          <h2>Choose a lane and lock it in</h2>
          <p>Injectables, PRP rituals, and skin lab innovations are displayed below. Tap to explore before booking.</p>
        </div>
        <div class="service-tabs">
          <button class="service-tab is-active" data-panel="injectables">Injectables</button>
          <button class="service-tab" data-panel="prp">PRP Rituals</button>
          <button class="service-tab" data-panel="peels">Skin Lab</button>
        </div>
        <div class="service-grid" id="panel-injectables">
          {% for item in injectables %}
          <article class="service-card">
            <div>
              <h3>{{ item.name }}</h3>
              <p>{{ item.details }}</p>
            </div>
            <div class="service-meta">
              <span>{{ item.price }}</span>
              <span>{{ item.duration }}</span>
            </div>
            <button class="btn btn--ghost add-to-cart" data-name="{{ item.name }}" type="button">Add to cart</button>
          </article>
          {% endfor %}
        </div>
        <div class="service-grid is-hidden" id="panel-prp">
          {% for item in prp %}
          <article class="service-card">
            <div>
              <h3>{{ item.name }}</h3>
              <p>{{ item.details }}</p>
            </div>
            <div class="service-meta">
              <span>{{ item.price }}</span>
              <span>{{ item.duration }}</span>
            </div>
            <button class="btn btn--ghost add-to-cart" data-name="{{ item.name }}" type="button">Add to cart</button>
          </article>
          {% endfor %}
        </div>
        <div class="service-grid is-hidden" id="panel-peels">
          {% for item in peels %}
          <article class="service-card">
            <div>
              <h3>{{ item.name }}</h3>
              <p>{{ item.details }}</p>
            </div>
            <div class="service-meta">
              <span>{{ item.price }}</span>
              <span>{{ item.duration }}</span>
            </div>
            <button class="btn btn--ghost add-to-cart" data-name="{{ item.name }}" type="button">Add to cart</button>
          </article>
          {% endfor %}
        </div>
      </section>

      <section class="section flow">
        <div class="section__header">
          <p class="eyebrow">Always-on concierge</p>
          <h2>Everything you need happens on one screen</h2>
        </div>
        <div class="flow-grid">
          <article>
            <span>01</span>
            <h3>Profile</h3>
            <p>Lock your preferences and share references using the form above.</p>
          </article>
          <article>
            <span>02</span>
            <h3>Select ritual</h3>
            <p>Compare pricing and timing in the ritual index; no PDFs or downloads.</p>
          </article>
          <article>
            <span>03</span>
            <h3>Book + deposit</h3>
            <p>Use the Square card element below to secure your seat instantly.</p>
          </article>
          <article>
            <span>04</span>
            <h3>Confirm</h3>
            <p>Automated email + SMS confirm your itinerary along with aftercare.</p>
          </article>
        </div>
      </section>

      <section id="providers" class="section team">
        <article>
          <p class="eyebrow">Clinical Director</p>
          <h2>Farah Bazzi, NP</h2>
          <p>
            Fearless facial balancing, bio-stimulators, and sculpted contours executed with a modern point of view. Farah
            leads clinical decisions, intake review, and post-visit analysis.
          </p>
          <ul>
            <li>Advanced contouring + midface restoration</li>
            <li>Strategic neurotoxin mapping</li>
            <li>Layered skin quality protocols</li>
          </ul>
        </article>
        <article>
          <p class="eyebrow">Aesthetic Partner</p>
          <h2>Malak Sabbagh, NP</h2>
          <p>
            Velvet lip stories, PRP revivals, and discreet maintenance sessions anchored by calm bedside manner and
            concierge communication.
          </p>
          <ul>
            <li>Lip flips, filler, and touch-ups</li>
            <li>PRP hair + under-eye restoration</li>
            <li>Smooth, discreet maintenance visits</li>
          </ul>
        </article>
      </section>

      <section id="booking" class="section booking">
        <div class="booking__intro">
          <p class="eyebrow">Reserve now</p>
          <h2>Secure your Glow Atelier appointment</h2>
          <p>
            Add your rituals to the cart, choose the exact date and time, and finalize a ${{ deposit_amount }} per-ritual
            deposit. Our concierge replies with your confirmed slot, prep instructions, and aftercare kit tracking.
          </p>
          <div class="contact-grid">
            <a href="mailto:concierge@glowatelier.com">concierge@glowatelier.com</a>
            <a href="tel:+13138883057">(313) 888-3057</a>
            <p>4700 Greenfield Rd Suite 2F · Dearborn</p>
          </div>
        </div>
        <div class="card glass payment-card">
          <h3>Cart, calendar, and deposit</h3>
          <p>Lock in your date and time, then pay a ${{ deposit_amount }} deposit for each ritual in your cart.</p>
          <div class="booking-grid">
            <div class="cart-panel">
              <div class="cart-header">
                <h4>Cart</h4>
                <p class="microcopy">Add rituals from the sections above.</p>
              </div>
              <ul id="cart-items" class="cart-list"></ul>
              <p id="empty-cart" class="microcopy">Your cart is empty. Add at least one ritual to continue.</p>
              <div class="cart-total">
                <span>Deposit due</span>
                <strong id="deposit-total">${{ deposit_amount }}.00</strong>
              </div>
            </div>
            <form
              id="deposit-form"
              data-deposit-cents="{{ deposit_amount * 100 }}"
              data-deposit-display="{{ deposit_amount }}"
              data-square-app="{{ square_application_id }}"
              data-square-location="{{ square_location_id }}"
            >
              <label for="appointment-date">Appointment date</label>
              <input id="appointment-date" name="appointment-date" type="date" required />
              <label for="appointment-time">Preferred time</label>
              <input id="appointment-time" name="appointment-time" type="time" required />
              <label for="guest-name">Guest name</label>
              <input id="guest-name" name="guest-name" type="text" placeholder="Full name" required />
              <label for="guest-email">Email</label>
              <input id="guest-email" name="guest-email" type="email" placeholder="you@example.com" required />
              <label for="guest-phone">Phone</label>
              <input id="guest-phone" name="guest-phone" type="tel" placeholder="(313) 555-1234" required />
              <label>Card details</label>
              <div id="card-element" class="card-element"></div>
              <button class="btn btn--primary" id="card-button" type="submit">Pay deposit</button>
              <p id="card-errors" role="alert"></p>
              <p class="microcopy">Instant receipts + aftercare delivered automatically to you and the clinical team.</p>
            </form>
          </div>
        </div>
      </section>
    </main>

    <footer>
      <p>Glow Atelier · Everything from profile to payment happens here.</p>
      <p>Follow @glowatelier and reply to confirmation emails for concierge support.</p>
    </footer>

    <script src="{{ square_js_src }}" defer></script>
    <script>
      const tabButtons = document.querySelectorAll('.service-tab');
      const tabPanels = {
        injectables: document.getElementById('panel-injectables'),
        prp: document.getElementById('panel-prp'),
        peels: document.getElementById('panel-peels')
      };

      tabButtons.forEach((button) => {
        button.addEventListener('click', () => {
          tabButtons.forEach((btn) => btn.classList.remove('is-active'));
          button.classList.add('is-active');
          Object.values(tabPanels).forEach((panel) => panel.classList.add('is-hidden'));
          const panel = tabPanels[button.dataset.panel];
          if (panel) {
            panel.classList.remove('is-hidden');
          }
        });
      });

      const profileForm = document.getElementById('profile-form');
      const profileSuccess = document.getElementById('profile-success');
      if (profileForm) {
        profileForm.addEventListener('submit', (event) => {
          event.preventDefault();
          profileSuccess.textContent = 'Profile captured. Jump to the booking section to secure your visit.';
          profileForm.reset();
        });
      }

      const initializeSquare = async () => {
        const depositForm = document.getElementById('deposit-form');
        const cardErrors = document.getElementById('card-errors');
        const cartList = document.getElementById('cart-items');
        const emptyCart = document.getElementById('empty-cart');
        const depositTotal = document.getElementById('deposit-total');
        const addToCartButtons = document.querySelectorAll('.add-to-cart');

        if (!depositForm) return;

        const depositPerItemCents = parseInt(depositForm.dataset.depositCents, 10) || 0;
        const depositPerItemDisplay = parseFloat(depositForm.dataset.depositDisplay || '0');
        const cart = [];

        const renderCart = () => {
          cartList.innerHTML = '';
          if (!cart.length) {
            emptyCart.style.display = 'block';
            depositTotal.textContent = '$0.00';
            return;
          }

          emptyCart.style.display = 'none';

          cart.forEach((item, index) => {
            const li = document.createElement('li');
            li.classList.add('cart-item');
            li.innerHTML = `
              <div>
                <p class="cart-item__name">${item.name}</p>
                <p class="microcopy">Quantity: ${item.quantity}</p>
              </div>
              <button type="button" class="remove-item" data-index="${index}">Remove</button>
            `;
            cartList.appendChild(li);
          });

          const totalQuantity = cart.reduce((sum, item) => sum + item.quantity, 0);
          const totalDeposit = depositPerItemDisplay * totalQuantity;
          depositTotal.textContent = `$${totalDeposit.toFixed(2)}`;
        };

        addToCartButtons.forEach((button) => {
          button.addEventListener('click', () => {
            const name = button.dataset.name;
            const existing = cart.find((item) => item.name === name);
            if (existing) {
              existing.quantity += 1;
            } else {
              cart.push({ name, quantity: 1 });
            }
            renderCart();
            cardErrors.textContent = '';
          });
        });

        cartList.addEventListener('click', (event) => {
          const target = event.target;
          if (target.classList.contains('remove-item')) {
            const index = parseInt(target.dataset.index, 10);
            cart.splice(index, 1);
            renderCart();
          }
        });

        if (!window.Square) {
          return;
        }

        const appId = depositForm.dataset.squareApp;
        const locationId = depositForm.dataset.squareLocation;

        if (!appId || !locationId) {
          cardErrors.textContent = 'Payment configuration is missing.';
          return;
        }

        let payments;
        try {
          payments = window.Square.payments(appId, locationId);
        } catch (error) {
          cardErrors.textContent = error.message;
          return;
        }

        let card;
        try {
          card = await payments.card();
          await card.attach('#card-element');
        } catch (error) {
          cardErrors.textContent = error.message;
          return;
        }

        depositForm.addEventListener('submit', async (event) => {
          event.preventDefault();
          cardErrors.textContent = '';

          if (!cart.length) {
            cardErrors.textContent = 'Add at least one ritual to your cart before checking out.';
            return;
          }

          const name = document.getElementById('guest-name').value;
          const email = document.getElementById('guest-email').value;
          const phone = document.getElementById('guest-phone').value;
          const appointmentDate = document.getElementById('appointment-date').value;
          const appointmentTime = document.getElementById('appointment-time').value;

          if (!appointmentDate || !appointmentTime) {
            cardErrors.textContent = 'Choose a date and time for your appointment.';
            return;
          }

          const totalQuantity = cart.reduce((sum, item) => sum + item.quantity, 0);
          const depositAmount = depositPerItemCents * totalQuantity;

          try {
            const result = await card.tokenize();
            if (result.status !== 'OK') {
              throw new Error(result.errors?.[0]?.message || 'Card could not be tokenized.');
            }

            const response = await fetch('/process-payment', {
              method: 'POST',
              headers: { 'Content-Type': 'application/json' },
              body: JSON.stringify({
                token: result.token,
                amount: depositAmount,
                name,
                email,
                phone,
                appointmentDate,
                appointmentTime,
                cart
              })
            });

            const data = await response.json();
            if (!response.ok) {
              throw new Error(data.error || 'Unable to finalize payment.');
            }

            cardErrors.textContent = 'Deposit received. Your calendar request and recap email are on the way.';
            depositForm.reset();
            cart.splice(0, cart.length);
            renderCart();
          } catch (error) {
            cardErrors.textContent = error.message;
          }
        });

        renderCart();
      };

      document.addEventListener('DOMContentLoaded', () => {
        initializeSquare();
      });
    </script>
  </body>
</html>
